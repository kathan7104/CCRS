<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Course Form - CCRS</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" href="/css/style.css"/>
</head>
<body class="role-director">
    <header class="dashboard-header">
        <h1>College Course Registration System</h1>
        <nav class="dashboard-nav">
            <a th:href="@{/director/dashboard}" class="nav-link">Dashboard</a>
            <a th:href="@{/director/courses}" class="nav-link active">Courses</a>
            <a th:href="@{/director/users}" class="nav-link">Faculty/Students</a>
            <a th:href="@{/director/assignments}" class="nav-link">Assignments</a>
        </nav>
        <div class="user-info">
            <span style="margin-right: 1rem;">Welcome, <span th:text="${#authentication.name}">Director</span></span>
            <form th:action="@{/auth/logout}" method="post" style="display: inline;">
                <button type="submit" class="btn btn-outline btn-sm">Logout</button>
            </form>
        </div>
    </header>

    <div class="dashboard-layout">
        <main class="dashboard-main">
            <section class="dashboard-section">
                <h2 th:text="${course.id == null ? 'Add Course' : 'Edit Course'}">Course Form</h2>

                <form th:action="${course.id == null} ? @{/director/courses} : @{/director/courses/{id}(id=${course.id})}" method="post">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="code">Course Code</label>
                            <input id="code" type="text" name="code" th:value="${course.code}" required/>
                        </div>
                        <div class="form-group">
                            <label for="name">Course Name</label>
                            <input id="name" type="text" name="name" th:value="${course.name}" required/>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="department">Department</label>
                            <input id="department" type="text" name="department" th:value="${course.department}" readonly class="readonly"/>
                        </div>
                        <div class="form-group">
                            <label for="programLevel">Program Level</label>
                            <input id="programLevel" type="text" name="programLevel" th:value="${course.programLevel}" required/>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="level">Level (Display)</label>
                            <input id="level" type="text" name="level" th:value="${course.level}" required/>
                        </div>
                        <div class="form-group">
                            <label for="durationYears">Duration (Years)</label>
                            <input id="durationYears" type="number" name="durationYears" th:value="${course.durationYears}" required min="1"/>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="capacity">Capacity</label>
                            <input id="capacity" type="number" name="capacity" th:value="${course.capacity}" required min="0"/>
                        </div>
                        <div class="form-group">
                            <label for="remainingSeats">Remaining Seats</label>
                            <input id="remainingSeats" type="number" name="remainingSeats" th:value="${course.remainingSeats}" min="0"/>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="credits">Credits</label>
                            <input id="credits" type="number" name="credits" th:value="${course.credits}" required min="0"/>
                        </div>
                        <div class="form-group">
                            <label for="fee">Fee (INR)</label>
                            <input id="fee" type="number" name="fee" th:value="${course.fee}" required min="0"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="requiredQualification">Required Qualification</label>
                        <input id="requiredQualification" type="text" name="requiredQualification" th:value="${course.requiredQualification}" required/>
                    </div>

                    <div class="form-group">
                        <label for="prerequisiteIds">Prerequisites</label>
                        <select id="prerequisiteIds" name="prerequisiteIds" multiple size="5">
                            <option th:each="c : ${allCourses}"
                                    th:value="${c.id}"
                                    th:text="${c.code + ' - ' + c.name}"
                                    th:selected="${course.prerequisites != null and course.prerequisites.contains(c)}">
                                CS101 - Intro
                            </option>
                        </select>
                        <p class="muted" style="margin-top: 0.4rem;">Hold Ctrl/Command to select multiple.</p>
                    </div>

                    <div class="form-row align-center">
                        <div class="form-group flex-1">
                            <a th:href="@{/director/courses}" class="btn btn-outline">Cancel</a>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary">Save Course</button>
                        </div>
                    </div>
                </form>
            </section>
        </main>
    </div>
</body>
</html>
